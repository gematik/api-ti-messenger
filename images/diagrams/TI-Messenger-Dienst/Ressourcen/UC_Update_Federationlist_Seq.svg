<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="2114px" preserveAspectRatio="none" style="width:1346px;height:2114px;background:#FFFFFF;" version="1.1" viewBox="0 0 1346 2114" width="1346px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="2102.0781" style="stroke:#181818;stroke-width:0.5;" width="222" x="26" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="170" x="52" y="24.6855">Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="52" y="42.1357"> </text><rect fill="#F5F5F5" height="2102.0781" style="stroke:#181818;stroke-width:0.5;" width="446" x="857" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="171" x="992.5" y="24.6855">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="1163.5" y="25.7842"> </text><rect fill="#DCDCDC" height="978.2813" style="stroke:#000000;stroke-width:1.0;" width="10" x="132" y="1055.4023"/><rect fill="#DCDCDC" height="846.125" style="stroke:#000000;stroke-width:1.0;" width="10" x="544" y="98.3867"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="549" y="837.1289"/><rect fill="#DCDCDC" height="858.9883" style="stroke:#000000;stroke-width:1.0;" width="10" x="544" y="1103.2188"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="549" y="1569.4727"/><rect fill="none" height="798" style="stroke:#000000;stroke-width:1.5;" width="937" x="392" y="153.5117"/><rect fill="none" height="760.5234" style="stroke:#000000;stroke-width:1.5;" width="917" x="402" y="183.9883"/><rect fill="none" height="551.0625" style="stroke:#000000;stroke-width:1.5;" width="897" x="412" y="386.4492"/><rect fill="none" height="412.1094" style="stroke:#000000;stroke-width:1.5;" width="486" x="422" y="518.4023"/><rect fill="#FFB6C1" height="66.7344" style="stroke:#000000;stroke-width:1.5;" width="406" x="432" y="548.8789"/><rect fill="none" height="202.0078" style="stroke:#000000;stroke-width:1.5;" width="466" x="432" y="721.5039"/><rect fill="none" height="124.9531" style="stroke:#000000;stroke-width:1.5;" width="877" x="432" y="1155.6523"/><rect fill="#FFB6C1" height="180.625" style="stroke:#000000;stroke-width:1.5;" width="646" x="20" y="1294.6055"/><rect fill="none" height="559.4531" style="stroke:#000000;stroke-width:1.5;" width="805" x="10" y="1489.2305"/><rect fill="none" height="242.8438" style="stroke:#000000;stroke-width:1.5;" width="646" x="20" y="1637.8555"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="137" x2="137" y1="88.3867" y2="2065.6836"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="549" x2="549" y1="88.3867" y2="2065.6836"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="968" x2="968" y1="88.3867" y2="2065.6836"/><line style="stroke:#000000;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1192" x2="1192" y1="88.3867" y2="2065.6836"/><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="30" y="48.9922"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="140" x="67" y="76.168">Messenger-Proxy</text><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="30" y="2064.6836"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="140" x="67" y="2091.8594">Messenger-Proxy</text><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="442" y="48.9922"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="176" x="461" y="76.168">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="442" y="2064.6836"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="176" x="461" y="2091.8594">Registrierungs-Dienst</text><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="861" y="48.9922"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="87" x="924.5" y="76.168">FHIR-Proxy</text><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="861" y="2064.6836"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="87" x="924.5" y="2091.8594">FHIR-Proxy</text><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1085" y="48.9922"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="114" x="1135" y="76.168">OAuth-Service</text><rect fill="#EFEFFF" height="38.3945" rx="2.5" ry="2.5" style="stroke:#000000;stroke-width:0.5;" width="214" x="1085" y="2064.6836"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="114" x="1135" y="2091.8594">OAuth-Service</text><rect fill="#DCDCDC" height="978.2813" style="stroke:#000000;stroke-width:1.0;" width="10" x="132" y="1055.4023"/><rect fill="#DCDCDC" height="846.125" style="stroke:#000000;stroke-width:1.0;" width="10" x="544" y="98.3867"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="549" y="837.1289"/><rect fill="#DCDCDC" height="858.9883" style="stroke:#000000;stroke-width:1.0;" width="10" x="544" y="1103.2188"/><rect fill="#DCDCDC" height="46.3828" style="stroke:#000000;stroke-width:1.0;" width="10" x="549" y="1569.4727"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1339" x="0" y="121.4492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1339" y1="121.4492" y2="121.4492"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1339" y1="124.4492" y2="124.4492"/><rect fill="#EEEEEE" height="28.125" style="stroke:#000000;stroke-width:2.0;" width="98" x="620.5" y="108.3867"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="80" x="626.5" y="128.9961">scheduled</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="706.5" y="129.6553"> </text><path d="M392,153.5117 L465,153.5117 L465,161.8633 L455,171.8633 L392,171.8633 L392,153.5117 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="798" style="stroke:#000000;stroke-width:1.5;" width="937" x="392" y="153.5117"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="407" y="168.0068">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="480" y="173.2197">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="49" x="484" y="172.1211">alle 1h</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="533" y="173.2197">]</text><path d="M402,183.9883 L463,183.9883 L463,192.3398 L453,202.3398 L402,202.3398 L402,183.9883 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="760.5234" style="stroke:#000000;stroke-width:1.5;" width="917" x="402" y="183.9883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="417" y="198.4834">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="478" y="203.6963">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="455" x="482" y="202.5977">HealthState_VZD=gesund ODER Alter_Föderationsliste&gt;=1h</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="937" y="203.6963">]</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="863" x="439" y="232.4648"/><path d="M439,232.4648 L501,232.4648 L501,240.4648 L491,250.4648 L439,250.4648 L439,232.4648 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="452" y="247.96">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="368" x="686.5" y="271.0742">Provider authentifizieren und Föderationsliste abrufen</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="402" x2="1319" y1="309.9414" y2="309.9414"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="407" y="327.6494">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="200" x="411" y="326.5508">HealthState_VZD!=gesund</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="611" y="327.6494">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="554" x2="596" y1="358.4492" y2="358.4492"/><line style="stroke:#000000;stroke-width:1.0;" x1="596" x2="596" y1="358.4492" y2="371.4492"/><line style="stroke:#000000;stroke-width:1.0;" x1="555" x2="596" y1="371.4492" y2="371.4492"/><polygon fill="#000000" points="565,367.4492,555,371.4492,565,375.4492,561,371.4492" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="395" x="561" y="352.7139">HealthStateCheck einleiten(HealthStateCheck_VZD=0)</text><path d="M412,386.4492 L485,386.4492 L485,394.8008 L475,404.8008 L412,404.8008 L412,386.4492 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="551.0625" style="stroke:#000000;stroke-width:1.5;" width="897" x="412" y="386.4492"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="28" x="427" y="400.9443">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="500" y="406.1572">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="316" x="504" y="405.0586">alle 5min UND HealthStateCheck_VZD&lt;=3</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="820" y="406.1572">]</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="863" x="439" y="434.9258"/><path d="M439,434.9258 L501,434.9258 L501,442.9258 L491,452.9258 L439,452.9258 L439,434.9258 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="452" y="450.4209">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="368" x="686.5" y="473.5352">Provider authentifizieren und Föderationsliste abrufen</text><path d="M422,518.4023 L483,518.4023 L483,526.7539 L473,536.7539 L422,536.7539 L422,518.4023 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="412.1094" style="stroke:#000000;stroke-width:1.5;" width="486" x="422" y="518.4023"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="437" y="532.8975">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="498" y="538.1104">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="196" x="502" y="537.0117">HealthState_VZD=gesund</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="698" y="538.1104">]</text><path d="M432,548.8789 L513,548.8789 L513,557.2305 L503,567.2305 L432,567.2305 L432,548.8789 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="66.7344" style="stroke:#000000;stroke-width:1.5;" width="406" x="432" y="548.8789"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="447" y="563.374">break</text><line style="stroke:#000000;stroke-width:1.0;" x1="554" x2="596" y1="594.6133" y2="594.6133"/><line style="stroke:#000000;stroke-width:1.0;" x1="596" x2="596" y1="594.6133" y2="607.6133"/><line style="stroke:#000000;stroke-width:1.0;" x1="555" x2="596" y1="607.6133" y2="607.6133"/><polygon fill="#000000" points="565,603.6133,555,607.6133,565,611.6133,561,607.6133" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="265" x="561" y="588.8779">HealthStateCheck_VZD abbrechen()</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="422" x2="908" y1="623.6133" y2="623.6133"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="427" y="641.3213">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="200" x="431" y="640.2227">HealthState_VZD!=gesund</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="631" y="641.3213">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="554" x2="596" y1="693.5039" y2="693.5039"/><line style="stroke:#000000;stroke-width:1.0;" x1="596" x2="596" y1="693.5039" y2="706.5039"/><line style="stroke:#000000;stroke-width:1.0;" x1="555" x2="596" y1="706.5039" y2="706.5039"/><polygon fill="#000000" points="565,702.5039,555,706.5039,565,710.5039,561,706.5039" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="235" x="561" y="666.3857">HealthStateCheck_VZD erhöhen</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="201" x="561" y="687.7686">(HealthStateCheck_VZD+1)</text><path d="M432,721.5039 L493,721.5039 L493,729.8555 L483,739.8555 L432,739.8555 L432,721.5039 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="202.0078" style="stroke:#000000;stroke-width:1.5;" width="466" x="432" y="721.5039"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="447" y="735.999">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="508" y="741.2119">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="196" x="512" y="740.1133">HealthStateCheck_VZD=3</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="708" y="741.2119">]</text><polygon fill="#000000" points="755,768.3633,765,772.3633,755,776.3633,759,772.3633" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="554" x2="761" y1="772.3633" y2="772.3633"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="189" x="561" y="766.6279">Incident-Event erzeugen()</text><line style="stroke:#000000;stroke-width:1.0;" x1="554" x2="601" y1="824.1289" y2="824.1289"/><line style="stroke:#000000;stroke-width:1.0;" x1="601" x2="601" y1="824.1289" y2="837.1289"/><line style="stroke:#000000;stroke-width:1.0;" x1="560" x2="601" y1="837.1289" y2="837.1289"/><polygon fill="#000000" points="570,833.1289,560,837.1289,570,841.1289,566,837.1289" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="315" x="566" y="797.0107">letzte vorhandene Föderationsliste puffern()</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="199" x="566" y="818.3936">{TTL_Föderationsliste=24h}</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="559" x2="601" y1="882.5117" y2="882.5117"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="601" x2="601" y1="882.5117" y2="895.5117"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="554" x2="601" y1="895.5117" y2="895.5117"/><polygon fill="#000000" points="564,891.5117,554,895.5117,564,899.5117,560,895.5117" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="566" y="876.7764">Föderationsliste</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1339" x="0" y="981.5742"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1339" y1="981.5742" y2="981.5742"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1339" y1="984.5742" y2="984.5742"/><rect fill="#EEEEEE" height="28.125" style="stroke:#000000;stroke-width:2.0;" width="100" x="619.5" y="968.5117"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="82" x="625.5" y="989.1211">on request</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="4" x="707.5" y="989.7803"> </text><polygon fill="#000000" points="153,1051.4023,143,1055.4023,153,1059.4023,149,1055.4023" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="147" x2="284" y1="1055.4023" y2="1055.4023"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="114" x="159" y="1028.2842">Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="103" x="159" y="1049.667">aktualisieren()</text><polygon fill="#000000" points="532,1099.2188,542,1103.2188,532,1107.2188,536,1103.2188" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="538" y1="1103.2188" y2="1103.2188"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="300" x="149" y="1097.4834">GET /I_internVerification(FLVersion_MP)</text><path d="M559,1068.4023 L559,1118.4023 L782,1118.4023 L782,1078.4023 L772,1068.4023 L559,1068.4023 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M772,1068.4023 L772,1078.4023 L782,1078.4023 L772,1068.4023 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="152" x="565" y="1090.0117">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="202" x="565" y="1110.1367">durch die gematik spezifiziert</text><path d="M432,1155.6523 L493,1155.6523 L493,1164.0039 L483,1174.0039 L432,1174.0039 L432,1155.6523 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="124.9531" style="stroke:#000000;stroke-width:1.5;" width="877" x="432" y="1155.6523"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="447" y="1170.1475">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="508" y="1175.3604">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="444" x="512" y="1174.2617">HealthState_VZD=gesund UND Alter_Föderationsliste&gt;=1h</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="960" y="1175.3604">]</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="863" x="439" y="1204.1289"/><path d="M439,1204.1289 L501,1204.1289 L501,1212.1289 L491,1222.1289 L439,1222.1289 L439,1204.1289 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="452" y="1219.624">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="368" x="686.5" y="1242.7383">Provider authentifizieren und Föderationsliste abrufen</text><path d="M20,1294.6055 L101,1294.6055 L101,1302.957 L91,1312.957 L20,1312.957 L20,1294.6055 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="180.625" style="stroke:#000000;stroke-width:1.5;" width="646" x="20" y="1294.6055"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="36" x="35" y="1309.1006">break</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="116" y="1314.3135">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="338" x="120" y="1313.2148">Alter_Föderationsliste&gt;TTL_Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="458" y="1314.3135">]</text><polygon fill="#000000" points="153,1341.4648,143,1345.4648,153,1349.4648,149,1345.4648" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147" x2="543" y1="1345.4648" y2="1345.4648"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="157" x="380" y="1339.7295">FLStatus_RD=veraltet</text><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="184" y1="1380.8477" y2="1380.8477"/><line style="stroke:#000000;stroke-width:1.0;" x1="184" x2="184" y1="1380.8477" y2="1393.8477"/><line style="stroke:#000000;stroke-width:1.0;" x1="143" x2="184" y1="1393.8477" y2="1393.8477"/><polygon fill="#000000" points="153,1389.8477,143,1393.8477,153,1397.8477,149,1393.8477" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="388" x="149" y="1375.1123">unterbinde Registrierungsdienst-Requests(Dauer=1h)</text><line style="stroke:#000000;stroke-width:1.0;" x1="142" x2="184" y1="1429.2305" y2="1429.2305"/><line style="stroke:#000000;stroke-width:1.0;" x1="184" x2="184" y1="1429.2305" y2="1442.2305"/><line style="stroke:#000000;stroke-width:1.0;" x1="143" x2="184" y1="1442.2305" y2="1442.2305"/><polygon fill="#000000" points="153,1438.2305,143,1442.2305,153,1446.2305,149,1442.2305" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="382" x="149" y="1423.4951">blockiere Kommunikation zu anderen Homeservern()</text><path d="M10,1489.2305 L71,1489.2305 L71,1497.582 L61,1507.582 L10,1507.582 L10,1489.2305 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="559.4531" style="stroke:#000000;stroke-width:1.5;" width="805" x="10" y="1489.2305"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="25" y="1503.7256">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="86" y="1508.9385">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="499" x="90" y="1507.8398">Alter_Föderationsliste&lt;1h ODER TTL_Föderationsliste vorhanden</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="589" y="1508.9385">]</text><line style="stroke:#000000;stroke-width:1.0;" x1="554" x2="601" y1="1556.4727" y2="1556.4727"/><line style="stroke:#000000;stroke-width:1.0;" x1="601" x2="601" y1="1556.4727" y2="1569.4727"/><line style="stroke:#000000;stroke-width:1.0;" x1="560" x2="601" y1="1569.4727" y2="1569.4727"/><polygon fill="#000000" points="570,1565.4727,560,1569.4727,570,1573.4727,566,1569.4727" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="153" x="566" y="1529.3545">vergleiche Versionen</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="237" x="566" y="1550.7373">(FLVersion_MP, FLVersion_RD)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="559" x2="601" y1="1614.8555" y2="1614.8555"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="601" x2="601" y1="1614.8555" y2="1627.8555"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="554" x2="601" y1="1627.8555" y2="1627.8555"/><polygon fill="#000000" points="564,1623.8555,554,1627.8555,564,1631.8555,560,1627.8555" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="172" x="566" y="1609.1201">Vergleichsergebnis_RD</text><path d="M20,1637.8555 L81,1637.8555 L81,1646.207 L71,1656.207 L20,1656.207 L20,1637.8555 " fill="#D3D3D3" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="242.8438" style="stroke:#000000;stroke-width:1.5;" width="646" x="20" y="1637.8555"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="16" x="35" y="1652.3506">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="96" y="1657.5635">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="260" x="100" y="1656.4648">Vergleichsergebnis_RD=identisch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="360" y="1657.5635">]</text><polygon fill="#000000" points="153,1709.7148,143,1713.7148,153,1717.7148,149,1713.7148" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147" x2="543" y1="1713.7148" y2="1713.7148"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="152" x="385" y="1707.9795">FLStatus_MP=aktuell</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="20" x2="666" y1="1747.7148" y2="1747.7148"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="25" y="1765.4229">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="264" x="29" y="1764.3242">Vergleichsergebnis_RD!=identisch</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="293" y="1765.4229">]</text><polygon fill="#000000" points="153,1792.2227,143,1796.2227,153,1800.2227,149,1796.2227" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147" x2="543" y1="1796.2227" y2="1796.2227"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="253" x="284" y="1790.4873">Föderationsliste, x5c-Zertifikatsliste</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="256" x="27" y="1804.2227"/><path d="M27,1804.2227 L89,1804.2227 L89,1812.2227 L79,1822.2227 L27,1822.2227 L27,1804.2227 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="40" y="1819.7178">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="248" x="31" y="1842.832">Signatur der Föderationsliste prüfen</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="815" y1="1913.6992" y2="1913.6992"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="15" y="1931.4072">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="445" x="19" y="1930.3086">FLÄnderungsFlag vorhanden ODER FLVersion_MP=NULL</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="4" x="464" y="1931.4072">]</text><polygon fill="#000000" points="153,1958.207,143,1962.207,153,1966.207,149,1962.207" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="147" x2="548" y1="1962.207" y2="1962.207"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="253" x="289" y="1956.4717">Föderationsliste, x5c-Zertifikatsliste</text><rect fill="none" height="46.4766" style="stroke:#000000;stroke-width:1.5;" width="256" x="27" y="1970.207"/><path d="M27,1970.207 L89,1970.207 L89,1978.207 L79,1988.207 L27,1988.207 L27,1970.207 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="17" x="40" y="1985.7021">ref</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="248" x="31" y="2008.8164">Signatur der Föderationsliste prüfen</text><!--MD5=[49dc25e182e95043008b2e6e60d8cf1e]
@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}

box <size:18>Messenger-Service\n #WhiteSmoke
participant MP as "Messenger-Proxy"
'participant MH as "Matrix-Homeserver"
end box
participant RD as "Registrierungs-Dienst"
box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
  participant FP as "FHIR-Proxy"
  participant AS as "OAuth-Service"
end box

== <size:16>scheduled</size> ==

loop#LightGrey <size:16>alle 1h</size>
  alt#LightGrey <size:16>HealthState_VZD=gesund ODER Alter_Föderationsliste>=1h</size>
  activate RD
  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||

  else <size:16>HealthState_VZD!=gesund</size>
    RD->RD: HealthStateCheck einleiten(HealthStateCheck_VZD=0)
    loop#LightGrey <size:16>alle 5min UND HealthStateCheck_VZD<=3</size>
      |||
      ref over AS, FP, RD
        <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
      end ref
      |||
      alt#LightGrey <size:16>HealthState_VZD=gesund</size>
        break#LightGrey #LightPink
          RD->RD: HealthStateCheck_VZD abbrechen()
        end
      else <size:16>HealthState_VZD!=gesund</size>
        RD->RD: HealthStateCheck_VZD erhöhen\n(HealthStateCheck_VZD+1)
        alt#LightGrey <size:16>HealthStateCheck_VZD=3</size>
          RD ->?: Incident-Event erzeugen()
          RD->RD++: letzte vorhandene Föderationsliste puffern() \n{TTL_Föderationsliste=24h}
          return Föderationsliste
        |||
        end
      end
    end 
    'RD-[hidden]> RD
    deactivate RD
  end
end

== <size:16>on request</size> ==

MP <-?: Föderationsliste \naktualisieren()
activate MP
MP->RD: GET /I_internVerification(FLVersion_MP) 
note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
|||
  Activate RD

alt#LightGrey <size:16>HealthState_VZD=gesund UND Alter_Föderationsliste>=1h </size>

  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||
  
'else <size:16>HealthState_VZD!=gesund ODER Alter_Föderationsliste<1h</size>
'else <size:16>Alter_Föderationsliste<1h ODER TTL_Föderationsliste vorhanden</size>

  'RD->RD: FLStatus_RD=aktuell

end

break#LightGrey #LightPink <size:16>Alter_Föderationsliste>TTL_Föderationsliste</size>
  'RD- ->MP: FLStatus_RD=veraltet
  RD- ->MP: FLStatus_RD=veraltet
  MP->MP: unterbinde Registrierungsdienst-Requests(Dauer=1h)
  MP->MP: blockiere Kommunikation zu anderen Homeservern()
  |||
end

alt#LightGrey <size:16>Alter_Föderationsliste<1h ODER TTL_Föderationsliste vorhanden</size>
  RD->RD++: vergleiche Versionen\n(FLVersion_MP, FLVersion_RD)
  return Vergleichsergebnis_RD
    
  alt#LightGrey <size:16>Vergleichsergebnis_RD=identisch</size>
    ||| 
    RD- ->MP: FLStatus_MP=aktuell
    |||
      
  else <size:16>Vergleichsergebnis_RD!=identisch</size>
    RD- ->MP: Föderationsliste, x5c-Zertifikatsliste
    ref over MP
      <size:16>Signatur der Föderationsliste prüfen</size>
    end ref
    |||
  end
  |||
  
else <size:16>FLÄnderungsFlag vorhanden ODER FLVersion_MP=NULL</size>
  RD- ->MP: Föderationsliste, x5c-Zertifikatsliste
  Deactivate RD
  ref over MP
    <size:16>Signatur der Föderationsliste prüfen</size>
  end ref
  MP-[hidden]> MP
  deactivate MP
end
@enduml

@startuml
skinparam sequenceMessageAlign direction
skinparam minClassWidth 200
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}

box <size:18>Messenger-Service\n #WhiteSmoke
participant MP as "Messenger-Proxy"
end box
participant RD as "Registrierungs-Dienst"
box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
  participant FP as "FHIR-Proxy"
  participant AS as "OAuth-Service"
end box

== <size:16>scheduled</size> ==

loop#LightGrey <size:16>alle 1h</size>
  alt#LightGrey <size:16>HealthState_VZD=gesund ODER Alter_Föderationsliste>=1h</size>
  activate RD
  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||

  else <size:16>HealthState_VZD!=gesund</size>
    RD->RD: HealthStateCheck einleiten(HealthStateCheck_VZD=0)
    loop#LightGrey <size:16>alle 5min UND HealthStateCheck_VZD<=3</size>
      |||
      ref over AS, FP, RD
        <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
      end ref
      |||
      alt#LightGrey <size:16>HealthState_VZD=gesund</size>
        break#LightGrey #LightPink
          RD->RD: HealthStateCheck_VZD abbrechen()
        end
      else <size:16>HealthState_VZD!=gesund</size>
        RD->RD: HealthStateCheck_VZD erhöhen\n(HealthStateCheck_VZD+1)
        alt#LightGrey <size:16>HealthStateCheck_VZD=3</size>
          RD ->?: Incident-Event erzeugen()
          RD->RD++: letzte vorhandene Föderationsliste puffern() \n{TTL_Föderationsliste=24h}
          return Föderationsliste
        |||
        end
      end
    end 
    deactivate RD
  end
end

== <size:16>on request</size> ==

MP <-?: Föderationsliste \naktualisieren()
activate MP
MP->RD: GET /I_internVerification(FLVersion_MP) 
note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
|||
  Activate RD

alt#LightGrey <size:16>HealthState_VZD=gesund UND Alter_Föderationsliste>=1h </size>

  |||
  ref over AS, FP, RD
    <size:16>Provider authentifizieren und Föderationsliste abrufen</size>
  end ref
  |||
  


end

break#LightGrey #LightPink <size:16>Alter_Föderationsliste>TTL_Föderationsliste</size>
  RD- ->MP: FLStatus_RD=veraltet
  MP->MP: unterbinde Registrierungsdienst-Requests(Dauer=1h)
  MP->MP: blockiere Kommunikation zu anderen Homeservern()
  |||
end

alt#LightGrey <size:16>Alter_Föderationsliste<1h ODER TTL_Föderationsliste vorhanden</size>
  RD->RD++: vergleiche Versionen\n(FLVersion_MP, FLVersion_RD)
  return Vergleichsergebnis_RD
    
  alt#LightGrey <size:16>Vergleichsergebnis_RD=identisch</size>
    ||| 
    RD- ->MP: FLStatus_MP=aktuell
    |||
      
  else <size:16>Vergleichsergebnis_RD!=identisch</size>
    RD- ->MP: Föderationsliste, x5c-Zertifikatsliste
    ref over MP
      <size:16>Signatur der Föderationsliste prüfen</size>
    end ref
    |||
  end
  |||
  
else <size:16>FLÄnderungsFlag vorhanden ODER FLVersion_MP=NULL</size>
  RD- ->MP: Föderationsliste, x5c-Zertifikatsliste
  Deactivate RD
  ref over MP
    <size:16>Signatur der Föderationsliste prüfen</size>
  end ref
  MP-[hidden]> MP
  deactivate MP
end
@enduml

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: Cp1252
Language: de
Country: DE
--></g></svg>