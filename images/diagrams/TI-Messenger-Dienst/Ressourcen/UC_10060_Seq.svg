<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2011px" preserveAspectRatio="none" style="width:1743px;height:2011px;background:#FFFFFF;" version="1.1" viewBox="0 0 1743 2011" width="1743px" zoomAndPan="magnify"><defs><filter height="300%" id="ftmktg8boslqf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#F5F5F5" height="1999.9688" style="stroke:#A80036;stroke-width:1.0;" width="265" x="246" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="93" x="329.5" y="22.708">Endgerät</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="0" x="427.5" y="23.8872"/><rect fill="#F5F5F5" height="1999.9688" style="stroke:#A80036;stroke-width:1.0;" width="565" x="932.5" y="6"/><text fill="#000000" font-family="sans-serif" font-size="18" font-weight="bold" lengthAdjust="spacing" textLength="200" x="1112.5" y="22.708">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="0" x="1317.5" y="23.8872"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="1452.6641" style="stroke:#000000;stroke-width:1.0;" width="10" x="373.5" y="361.7422"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="114.0977" style="stroke:#000000;stroke-width:1.0;" width="10" x="660.5" y="409.2617"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="1111.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="660.5" y="649.7266"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="1015.5" y="1256.5703"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="234.5234" style="stroke:#000000;stroke-width:1.0;" width="10" x="1221.5" y="1435.5156"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="1404.5" y="1535.8828"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="133.8594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1602" y="934.5078"/><rect fill="#FFFFFF" filter="url(#ftmktg8boslqf)" height="1596.7891" style="stroke:#000000;stroke-width:2.0;" width="1719.5" x="10" y="250.6172"/><rect fill="#FFFFFF" filter="url(#ftmktg8boslqf)" height="436.6406" style="stroke:#000000;stroke-width:2.0;" width="1181.5" x="538" y="689.7266"/><rect fill="#FFFFFF" filter="url(#ftmktg8boslqf)" height="537.6719" style="stroke:#000000;stroke-width:2.0;" width="1028.5" x="538" y="1165.3672"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="116" x2="116" y1="118.5625" y2="1889.4063"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="378" x2="378" y1="118.5625" y2="1889.4063"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="665" x2="665" y1="118.5625" y2="1889.4063"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1020.5" x2="1020.5" y1="118.5625" y2="1889.4063"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1226.5" x2="1226.5" y1="118.5625" y2="1889.4063"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1409.5" x2="1409.5" y1="118.5625" y2="1889.4063"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:5.0,5.0;" x1="1606.5" x2="1606.5" y1="934.8594" y2="1889.4063"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="90.5645">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="113.8457">Org-Admin</text><ellipse cx="116.5" cy="15" fill="#DCDCDC" filter="url(#ftmktg8boslqf)" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M116.5,23 L116.5,50 M103.5,31 L129.5,31 M116.5,50 L103.5,65 M116.5,50 L129.5,65 " fill="none" filter="url(#ftmktg8boslqf)" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="187" x="20" y="1906.9707">Akteur in der Rolle</text><text fill="#000000" font-family="Aapex" font-size="20" lengthAdjust="spacing" textLength="110" x="58.5" y="1930.252">Org-Admin</text><ellipse cx="116.5" cy="1944.9688" fill="#DCDCDC" filter="url(#ftmktg8boslqf)" rx="8" ry="8" style="stroke:#000000;stroke-width:2.0;"/><path d="M116.5,1952.9688 L116.5,1979.9688 M103.5,1960.9688 L129.5,1960.9688 M116.5,1979.9688 L103.5,1994.9688 M116.5,1979.9688 L129.5,1994.9688 " fill="none" filter="url(#ftmktg8boslqf)" style="stroke:#000000;stroke-width:2.0;"/><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="60.5625" style="stroke:#000000;stroke-width:1.5;" width="253" x="250" y="53"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="310.5" y="78.5645">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="257" y="101.8457">Registrierungs-Dienstes</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="60.5625" style="stroke:#000000;stroke-width:1.5;" width="253" x="250" y="1888.4063"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="132" x="310.5" y="1913.9707">Frontend des</text><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="239" x="257" y="1937.252">Registrierungs-Dienstes</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="231" x="548" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="555" y="101.8457">Registrierungs-Dienst</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="231" x="548" y="1888.4063"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="217" x="555" y="1913.9707">Registrierungs-Dienst</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="164" x="936.5" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="144" x="946.5" y="101.8457">OAuth-Service</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="164" x="936.5" y="1888.4063"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="144" x="946.5" y="1913.9707">OAuth-Service</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="164" x="1142.5" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="1170.5" y="101.8457">FHIR-Proxy</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="164" x="1142.5" y="1888.4063"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="108" x="1170.5" y="1913.9707">FHIR-Proxy</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="164" x="1325.5" y="76.2813"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1335" y="101.8457">FHIR-Directory</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="164" x="1325.5" y="1888.4063"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="145" x="1335" y="1913.9707">FHIR-Directory</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="201" x="1504.5" y="1888.4063"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="187" x="1511.5" y="1913.9707">Messenger-Service</text><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="1452.6641" style="stroke:#000000;stroke-width:1.0;" width="10" x="373.5" y="361.7422"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="114.0977" style="stroke:#000000;stroke-width:1.0;" width="10" x="660.5" y="409.2617"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="1111.1016" style="stroke:#000000;stroke-width:1.0;" width="10" x="660.5" y="649.7266"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="1015.5" y="1256.5703"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="234.5234" style="stroke:#000000;stroke-width:1.0;" width="10" x="1221.5" y="1435.5156"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="100.3672" style="stroke:#000000;stroke-width:1.0;" width="10" x="1404.5" y="1535.8828"/><rect fill="#DCDCDC" filter="url(#ftmktg8boslqf)" height="133.8594" style="stroke:#000000;stroke-width:1.0;" width="10" x="1602" y="934.5078"/><rect fill="#FFFFFF" filter="url(#ftmktg8boslqf)" height="60.0547" style="stroke:#000000;stroke-width:2.0;" width="765" x="17" y="153.5625"/><path d="M17,153.5625 L83,153.5625 L83,160.5625 L73,170.5625 L17,170.5625 L17,153.5625 " fill="#98FB98" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="30" y="167.6294">ref</text><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="98" x="98.5" y="190.3423">AF: 10103</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="503" x="201.5" y="190.3423">- Authentisieren einer Organisation am TI-Messenger-Dienst</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="0" x="102.5" y="206.4185"/><path d="M10,250.6172 L87,250.6172 L87,257.6172 L77,267.6172 L10,267.6172 L10,250.6172 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="1596.7891" style="stroke:#000000;stroke-width:2.0;" width="1719.5" x="10" y="250.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="32" x="25" y="263.6841">loop</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="102" y="268.6479">[</text><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="34" x="107" y="267.4688">1..n</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="5" x="141" y="268.6479">]</text><polygon fill="#000000" points="361.5,357.7422,371.5,361.7422,361.5,365.7422,365.5,361.7422" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="367.5" y1="361.7422" y2="361.7422"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="216" x="123.5" y="316.1548">Mit einem Admin-Account</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="213" x="123.5" y="335.9438">am Registrierungs-Dienst</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="84" x="123.5" y="355.7329">anmelden</text><polygon fill="#000000" points="648.5,405.2617,658.5,409.2617,648.5,413.2617,652.5,409.2617" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="654.5" y1="409.2617" y2="409.2617"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="258" x="390.5" y="403.2524">POST /login (Client-Credential)</text><path d="M675,374.7422 L675,421.7422 L923,421.7422 L923,384.7422 L913,374.7422 L675,374.7422 " fill="#FBFB77" filter="url(#ftmktg8boslqf)" style="stroke:#A80036;stroke-width:1.0;"/><path d="M913,374.7422 L913,384.7422 L923,384.7422 L913,374.7422 " fill="#FBFB77" style="stroke:#A80036;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="174" x="681" y="394.5938">Schnittstelle wird nicht</text><text fill="#000000" font-family="sans-serif" font-size="16" lengthAdjust="spacing" textLength="227" x="681" y="413.2188">durch die gematik spezifiziert</text><line style="stroke:#000000;stroke-width:1.0;" x1="670.5" x2="712.5" y1="476.5703" y2="476.5703"/><line style="stroke:#000000;stroke-width:1.0;" x1="712.5" x2="712.5" y1="476.5703" y2="489.5703"/><line style="stroke:#000000;stroke-width:1.0;" x1="671.5" x2="712.5" y1="489.5703" y2="489.5703"/><polygon fill="#000000" points="681.5,485.5703,671.5,489.5703,681.5,493.5703,677.5,489.5703" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="143" x="677.5" y="450.772">Client-Credential</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="55" x="677.5" y="470.561">prüfen</text><polygon fill="#000000" points="394.5,519.3594,384.5,523.3594,394.5,527.3594,390.5,523.3594" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="388.5" x2="664.5" y1="523.3594" y2="523.3594"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="607.5" y="517.3501">status</text><polygon fill="#000000" points="127.5,553.1484,117.5,557.1484,127.5,561.1484,123.5,557.1484" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="121.5" x2="372.5" y1="557.1484" y2="557.1484"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="195" x="171.5" y="551.1392">Erfolgreich angemeldet</text><polygon fill="#000000" points="361.5,611.9375,371.5,615.9375,361.5,619.9375,365.5,615.9375" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="116.5" x2="367.5" y1="615.9375" y2="615.9375"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="233" x="123.5" y="609.9282">Messenger Service erstellen</text><polygon fill="#000000" points="648.5,645.7266,658.5,649.7266,648.5,653.7266,652.5,649.7266" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="383.5" x2="654.5" y1="649.7266" y2="649.7266"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="252" x="390.5" y="643.7173">POST /create (Matrix-Domain)</text><path d="M538,689.7266 L833,689.7266 L833,699.7266 L823,709.7266 L538,709.7266 L538,689.7266 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="436.6406" style="stroke:#000000;stroke-width:2.0;" width="1181.5" x="538" y="689.7266"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="250" x="553" y="705.5781">Messaging-Service erstellen</text><line style="stroke:#000000;stroke-width:1.0;" x1="670.5" x2="712.5" y1="761.1406" y2="761.1406"/><line style="stroke:#000000;stroke-width:1.0;" x1="712.5" x2="712.5" y1="761.1406" y2="774.1406"/><line style="stroke:#000000;stroke-width:1.0;" x1="671.5" x2="712.5" y1="774.1406" y2="774.1406"/><polygon fill="#000000" points="681.5,770.1406,671.5,774.1406,681.5,778.1406,677.5,774.1406" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="319" x="677.5" y="755.1313">Prüfung auf zulässigen Domainnamen</text><line style="stroke:#000000;stroke-width:1.0;" x1="670.5" x2="712.5" y1="852.7188" y2="852.7188"/><line style="stroke:#000000;stroke-width:1.0;" x1="712.5" x2="712.5" y1="852.7188" y2="865.7188"/><line style="stroke:#000000;stroke-width:1.0;" x1="671.5" x2="712.5" y1="865.7188" y2="865.7188"/><polygon fill="#000000" points="681.5,861.7188,671.5,865.7188,681.5,869.7188,677.5,865.7188" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="271" x="677.5" y="826.9204">Starte neuen Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="331" x="677.5" y="846.7095">für die Organisation mit Matrix-Domain</text><polygon fill="#000000" points="1492.5,920.5078,1502.5,924.5078,1492.5,928.5078,1496.5,924.5078" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="670.5" x2="1498.5" y1="924.5078" y2="924.5078"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="234" x="677.5" y="918.4985">Messenger-Service erstellen</text><rect fill="#EFEFFF" filter="url(#ftmktg8boslqf)" height="37.2813" style="stroke:#000000;stroke-width:1.5;" width="201" x="1504.5" y="898.7188"/><text fill="#000000" font-family="Impact" font-size="20" lengthAdjust="spacing" textLength="187" x="1511.5" y="924.2832">Messenger-Service</text><line style="stroke:#000000;stroke-width:1.0;" x1="1612" x2="1654" y1="1021.5781" y2="1021.5781"/><line style="stroke:#000000;stroke-width:1.0;" x1="1654" x2="1654" y1="1021.5781" y2="1034.5781"/><line style="stroke:#000000;stroke-width:1.0;" x1="1613" x2="1654" y1="1034.5781" y2="1034.5781"/><polygon fill="#000000" points="1623,1030.5781,1613,1034.5781,1623,1038.5781,1619,1034.5781" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="48" x="1619" y="995.7798">initial</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="85" x="1619" y="1015.5688">einrichten</text><polygon fill="#000000" points="681.5,1064.3672,671.5,1068.3672,681.5,1072.3672,677.5,1068.3672" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="1606" y1="1068.3672" y2="1068.3672"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="1549" y="1062.3579">status</text><path d="M538,1165.3672 L1013,1165.3672 L1013,1175.3672 L1003,1185.3672 L538,1185.3672 L538,1165.3672 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.0;"/><rect fill="none" height="537.6719" style="stroke:#000000;stroke-width:2.0;" width="1028.5" x="538" y="1165.3672"/><text fill="#000000" font-family="sans-serif" font-size="16" font-weight="bold" lengthAdjust="spacing" textLength="430" x="553" y="1181.2188">Messenger-Service in die Föderation aufnehmen</text><polygon fill="#000000" points="1003.5,1252.5703,1013.5,1256.5703,1003.5,1260.5703,1007.5,1256.5703" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="670.5" x2="1009.5" y1="1256.5703" y2="1256.5703"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="307" x="677.5" y="1230.772">POST /token (client_id, client_secret)</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="259" x="677.5" y="1250.561">(OAuth Client credentials flow)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1025.5" x2="1067.5" y1="1310.1484" y2="1310.1484"/><line style="stroke:#000000;stroke-width:1.0;" x1="1067.5" x2="1067.5" y1="1310.1484" y2="1323.1484"/><line style="stroke:#000000;stroke-width:1.0;" x1="1026.5" x2="1067.5" y1="1323.1484" y2="1323.1484"/><polygon fill="#000000" points="1036.5,1319.1484,1026.5,1323.1484,1036.5,1327.1484,1032.5,1323.1484" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="156" x="1032.5" y="1284.3501">prüfe client_id und</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="105" x="1032.5" y="1304.1392">client_secret</text><polygon fill="#000000" points="681.5,1352.9375,671.5,1356.9375,681.5,1360.9375,677.5,1356.9375" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="1019.5" y1="1356.9375" y2="1356.9375"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="854.5" y="1350.9282">admin-accesstoken</text><polygon fill="#000000" points="1209.5,1431.5156,1219.5,1435.5156,1209.5,1439.5156,1213.5,1435.5156" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="670.5" x2="1215.5" y1="1435.5156" y2="1435.5156"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="437" x="677.5" y="1409.7173">POST /tim-provider-services/addTiMessengerDomain</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="532" x="677.5" y="1429.5063">(admin-accesstoken, Matrix-Domain, TelematikID, isEnsurance)</text><line style="stroke:#000000;stroke-width:1.0;" x1="1231.5" x2="1273.5" y1="1489.0938" y2="1489.0938"/><line style="stroke:#000000;stroke-width:1.0;" x1="1273.5" x2="1273.5" y1="1489.0938" y2="1502.0938"/><line style="stroke:#000000;stroke-width:1.0;" x1="1232.5" x2="1273.5" y1="1502.0938" y2="1502.0938"/><polygon fill="#000000" points="1242.5,1498.0938,1232.5,1502.0938,1242.5,1506.0938,1238.5,1502.0938" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="44" x="1238.5" y="1463.2954">prüfe</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="159" x="1238.5" y="1483.0845">admin-accesstoken</text><polygon fill="#000000" points="1392.5,1531.8828,1402.5,1535.8828,1392.5,1539.8828,1396.5,1535.8828" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="1231.5" x2="1398.5" y1="1535.8828" y2="1535.8828"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="1238.5" y="1529.8735">HTTPS Forward</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1414.5" x2="1456.5" y1="1589.4609" y2="1589.4609"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1456.5" x2="1456.5" y1="1589.4609" y2="1602.4609"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1415.5" x2="1456.5" y1="1602.4609" y2="1602.4609"/><polygon fill="#000000" points="1425.5,1598.4609,1415.5,1602.4609,1425.5,1606.4609,1421.5,1602.4609" style="stroke:#000000;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="133" x="1421.5" y="1563.6626">Föderationsliste</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="109" x="1421.5" y="1583.4517">aktualisieren</text><polygon fill="#000000" points="1242.5,1632.25,1232.5,1636.25,1242.5,1640.25,1238.5,1636.25" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="1236.5" x2="1408.5" y1="1636.25" y2="1636.25"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="1351.5" y="1630.2407">status</text><polygon fill="#000000" points="681.5,1666.0391,671.5,1670.0391,681.5,1674.0391,677.5,1670.0391" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="675.5" x2="1225.5" y1="1670.0391" y2="1670.0391"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="128" x="1091.5" y="1664.0298">HTTPS Forward</text><polygon fill="#000000" points="394.5,1756.8281,384.5,1760.8281,394.5,1764.8281,390.5,1760.8281" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="388.5" x2="664.5" y1="1760.8281" y2="1760.8281"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="51" x="607.5" y="1754.8188">status</text><polygon fill="#000000" points="127.5,1810.4063,117.5,1814.4063,127.5,1818.4063,123.5,1814.4063" style="stroke:#000000;stroke-width:1.0;"/><line style="stroke:#000000;stroke-width:1.0;" x1="121.5" x2="377.5" y1="1814.4063" y2="1814.4063"/><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="155" x="211.5" y="1788.6079">Messenger Service</text><text fill="#000000" font-family="sans-serif" font-size="17" lengthAdjust="spacing" textLength="153" x="218.5" y="1808.397">erfolgreich erstellt</text><!--MD5=[10e70d4cd8cbe2353126976a315133c1]
@startuml
skinparam sequenceMessageAlign direction
skinparam WrapWidth 300
skinparam minClassWidth 150
skinparam BoxPadding 1
skinparam sequenceReferenceHeaderBackgroundColor palegreen
scale max 2048 width

skinparam sequence {
ArrowColor black
ArrowFontSize 17
ActorBorderColor black
LifeLineBorderColor black
LifeLineBackgroundColor Gainsboro

ParticipantBorderColor Motivation
ParticipantBackgroundColor Motivation
ParticipantFontName Impact
ParticipantFontSize 20
ParticipantFontColor black
ParticipantBorderColor Black
ParticipantBackgroundColor MOTIVATION

ActorBackgroundColor Gainsboro
ActorFontColor black
ActorFontSize 20
ActorFontName Aapex
}
    actor U as "Akteur in der Rolle\nOrg-Admin"
    box <size:18>Endgerät</size> #WhiteSmoke
      participant C as "Frontend des\nRegistrierungs-Dienstes"
    end box
    participant R as "Registrierungs-Dienst"
    box <size:18>VZD-FHIR-Directory</size> #WhiteSmoke
    participant Auth as "OAuth-Service"
    participant FP as "FHIR-Proxy"
    participant VZD as "FHIR-Directory"
    end box

|||
ref over U, R: <size:17>**AF: 10103** - Authentisieren einer Organisation am TI-Messenger-Dienst</size>\n 
|||

loop <size:16>1..n</size>
  |||
  U->C: Mit einem Admin-Account \nam Registrierungs-Dienst \nanmelden
    Activate C
  C->R: POST /login (Client-Credential)
  note right: <size:16>Schnittstelle wird nicht \n<size:16>durch die gematik spezifiziert</size>
    Activate R
  R->R: Client-Credential \nprüfen
  R- ->C: status
    Deactivate R
  C- ->U: Erfolgreich angemeldet
  |||
  U->C: Messenger Service erstellen
  C->R: POST /create (Matrix-Domain)
    Activate R
    
    |||
    group <size:16>Messaging-Service erstellen</size>
    |||
      R->R: Prüfung auf zulässigen Domainnamen
      |||
      R->R: Starte neuen Messenger-Service \nfür die Organisation mit Matrix-Domain
      |||
        create "Messenger-Service"
          R- ->"Messenger-Service" : Messenger-Service erstellen 
        Activate "Messenger-Service"
      |||
      "Messenger-Service"->"Messenger-Service": initial \neinrichten
      "Messenger-Service"- ->R: status
      |||
        Deactivate "Messenger-Service"
    |||
    end
    
    |||
    
    group <size:16>Messenger-Service in die Föderation aufnehmen</size>
    |||
      R->Auth: POST /token (client_id, client_secret) \n(OAuth Client credentials flow)
        Activate Auth
      Auth->Auth: prüfe client_id und \nclient_secret
      Auth- ->R: admin-accesstoken
        Deactivate Auth
      |||
      R->FP: POST /tim-provider-services/addTiMessengerDomain \n(admin-accesstoken, Matrix-Domain, TelematikID, isEnsurance)
        Activate FP
      FP->FP: prüfe \nadmin-accesstoken
      FP->VZD: HTTPS Forward
        Activate VZD
      VZD- ->VZD: Föderationsliste\naktualisieren
      VZD- ->FP: status
        Deactivate VZD
      FP- ->R: HTTPS Forward
        Deactivate FP

    |||
    end

  |||
  R->C: status
    Deactivate R
  C->U: Messenger Service \nerfolgreich erstellt
    Deactivate C
  |||
end
|||
@enduml

PlantUML version 1.2021.16(Wed Dec 08 17:25:22 UTC 2021)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: null
--></g></svg>